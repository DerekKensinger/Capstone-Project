{% extends "base.html" %}
{% block title %}DFS Optimizer{% endblock %}
{% block content %}
<h1 align="center">DFS Optimizer</h1>
<form method="POST" onsubmit="updateResults(event)">
    <!-- Input fields for race selection and number of lineups -->
    <div class="form-group">
        <label for="race">Select a Race:</label>
        <select id="race" name="race" class="form-control">
            <!-- Populate this dropdown with race options -->
        </select>
    </div>
    <div class="form-group">
        <label for="lineups">Number of Lineups:</label>
        <input type="number" id="lineups" name="lineups" class="form-control" required>
    </div>
    <!-- Hidden input field to store JSON data -->
    <input type="hidden" id="results-data" name="results" value="{{ results | tojson }}">
    <button type="submit" class="btn btn-primary">Run Optimizer</button>
</form>
<div id="optimizer-results"></div>
{% endblock %}

{% block scripts %}
<script>
    // Function to update the DFS optimizer results
    function updateResults(event) {
        event.preventDefault();
        // Retrieve the JSON data from the hidden input field
        var resultsJson = document.getElementById("results-data").value;
        var data = JSON.parse(resultsJson);

        var resultsDiv = document.getElementById("optimizer-results");
        resultsDiv.innerHTML = ""; // Clear previous results

        if (data.optimized_lineups.length > 0) {
            // Create a table to display the results
            var table = document.createElement("table");
            table.classList.add("table", "table-bordered");

            // Create the table header
            var thead = document.createElement("thead");
            var headerRow = document.createElement("tr");
            ["Constructor", "Driver 1", "Driver 2", "Driver 3", "Driver 4", "CPT", "Total Points"].forEach(function (header) {
                var th = document.createElement("th");
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Create the table body
            var tbody = document.createElement("tbody");
            data.optimized_lineups.forEach(function (lineup) {
                var row = document.createElement("tr");
                lineup.forEach(function (cell) {
                    var td = document.createElement("td");
                    td.textContent = cell;
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            });
            table.appendChild(tbody);

            // Add the table to the results div
            resultsDiv.appendChild(table);
        } else {
            // Display a message if no results are available
            resultsDiv.textContent = "No optimized lineups found.";
        }
    }
</script>
{% endblock %}

